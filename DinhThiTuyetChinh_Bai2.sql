CREATE DATABASE DB_QLHV

ON PRIMARY
(
	NAME = 'DBQLHV_PRIMARY',
	FILENAME = 'D:\DBQLHV_PRIMARY.mdf',
	SIZE = 5MB,
	MAXSIZE = 10MB,
	FILEGROWTH = 10%
)
LOG ON
(
	NAME = 'DBQLHV_LOG',
	FILENAME = 'D:\DBQLHV_LOG.ldf',
	SIZE = 3MB,
	MAXSIZE = 5MB,
	FILEGROWTH = 15%
)

USE DB_QLHV
GO

CREATE TABLE LOPHOC
(
	MALOP CHAR(10) NOT NULL,
	SISO INT, 
	LOPTRUONG CHAR(10),
	GVQUANLI CHAR(10),
	NAMBATDAU INT,
	NAMKETTHUC INT,
	 CONSTRAINT PK_LOPHOC PRIMARY KEY(MALOP)
)

CREATE TABLE HOCVIEN
(
 MAHOCVIEN CHAR(10) NOT NULL,
 TENHOCVIEN NVARCHAR (50),
 NGAYSINH DATE,
 TINHTRANG NVARCHAR(30),
 MALOP CHAR(10),
 CONSTRAINT PK_HOCVIEN PRIMARY KEY(MAHOCVIEN),
 CONSTRAINT FK_HV_LOP FOREIGN KEY (MALOP) REFERENCES LOPHOC(MALOP)
)


CREATE TABLE GIAOVIEN
(
 MAGV CHAR(10) NOT NULL,
 TENGV NVARCHAR (50),
 NGAYSINH DATE,
 GIOITINH NVARCHAR(10),
 DIENTHOAI CHAR(30),
 MAGVQUANLI CHAR(10),
 CONSTRAINT PK_GV PRIMARY KEY(MAGV),
  CONSTRAINT FK_GV_GV FOREIGN KEY (MAGVQUANLI) REFERENCES GIAOVIEN(MAGV)
)

CREATE TABLE MONHOC
(
	MAMONHOC CHAR(10) NOT NULL,
	TENMONHOC NVARCHAR(50),
	SOCHI INT,
	CONSTRAINT PK_MH PRIMARY KEY (MAMONHOC)
)

CREATE TABLE KETQUA
(
 MAHOCVIEN CHAR(10) NOT NULL,
 MAMONHOC CHAR(10) NOT NULL,
 LANTHI INT NOT NULL, 
 DIEM FLOAT,
 CONSTRAINT PK_KQ PRIMARY KEY (MAHOCVIEN, MAMONHOC, LANTHI),
 CONSTRAINT FK_KQ_HV FOREIGN KEY (MAHOCVIEN) REFERENCES HOCVIEN(MAHOCVIEN),
 CONSTRAINT FK_KQ_MH FOREIGN KEY (MAMONHOC) REFERENCES MONHOC(MAMONHOC)
 )

 CREATE TABLE PHANCONG
 (
 MAGV CHAR(10) NOT NULL,
 MAMH CHAR(10) NOT NULL,
 MALOP CHAR(10) NOT NULL,
 CONSTRAINT PK_PC PRIMARY KEY (MAGV, MAMH, MALOP),
 CONSTRAINT FK_PC_GV FOREIGN KEY (MAGV) REFERENCES GIAOVIEN(MAGV),
 CONSTRAINT FK_PC_MH FOREIGN KEY (MAMH) REFERENCES MONHOC(MAMONHOC),
 CONSTRAINT FK_PC_LH FOREIGN KEY (MALOP) REFERENCES LOPHOC(MALOP)

 )

 CREATE TABLE GIAOVIEN_DAY_MONHOC
 (
 MAGV CHAR(10) NOT NULL,
 MAMH CHAR(10) NOT NULL,
 THAMNIEN INT,
 SOLOPDADAY INT,
 CONSTRAINT PK_DAY PRIMARY KEY (MAGV, MAMH),
 CONSTRAINT FK_DAY_GV FOREIGN KEY (MAGV) REFERENCES GIAOVIEN(MAGV),
 CONSTRAINT FK_DAY_MH FOREIGN KEY (MAMH) REFERENCES MONHOC(MAMONHOC)
 )

 INSERT INTO LOPHOC
 VALUES
 ('LH000001', 1, 'HV000002', 'GV00001', 2010, 2014),
 ('LH000002', 1, 'HV000003', 'GV00003', 2009, 2013),
 ('LH000003', 2, 'HV000004', 'GV00008', 2010, 2014),
 ('LH000004', 4, 'HV000008', 'GV000010', 2011, 2015),
 ('LH000005', 1, 'HV000009', 'GV00009', 2010, 2014)

 INSERT INTO MONHOC
 VALUES
 ('MH00001', N'Cơ sở dữ liệu', 5),
 ('MH00002', N'Cấu trúc dữ liệu', 6),
 ('MH00003', N'Mạng máy tính', 4),
 ('MH00004', N'Toán cao cấp', 6),
 ('MH00005', N'Tin học cơ sở', 3),
 ('MH00006', N'Công nghệ phần mềm', 4),
 ('MH00007', N'Trí tuệ nhân tạo', 4),
 ('MH00008', N'Khai thác dữ liệu', 3),
 ('MH00009', N'Phân tích thiết kế hệ thống thông tin', 3),
 ('MH00010', N'Hệ thống thông minh', 4)


 SET DATEFORMAT DMY
 INSERT INTO HOCVIEN 
 VALUES
 ('HV000001', N'Nguyễn Thuỳ Linh', '01/02/1990', N'Buộc thôi học', 'LH000001'),
 ('HV000002', N'Nguyễn Thị Kiều', '20/12/1993', N'Đang học', 'LH000001'),
 ('HV000003', N'Nguyễn Xuân Thu', '30/12/1994', N'Đang học', 'LH000002'),
 ('HV000004', N'Trần Trung Chính', '12/03/1992', N'Đang học', 'LH000003'),
 ('HV000005', N'Trần Minh An', '03/12/1991', N'Đang học', 'LH000003'),
 ('HV000006', N'Trương Mỹ Linh', '12/12/1989', N'Đã tốt nghiệp', 'LH000004'),
 ('HV000007', N'Trần Hào', '02/02/1989', N'Đã tốt nghiệp', 'LH000004'),
 ('HV000008', N'Nguyễn Huỳnh', '03/03/1992', N'Đang học', 'LH000004'),
 ('HV000009', N'Nguyễn Xuân Trường', '12/03/1993', N'Đang học', 'LH000005'),
 ('HV0000010', N'Nguyễn Bình Minh', '12/03/1992', N'Đang học', 'LH000004')

 SET DATEFORMAT DMY
 INSERT INTO GIAOVIEN
 VALUES
 ('GV00001', N'Nguyễn Văn An', '02-01-1981', N'Nam', NULL, 'GV00002'),
 ('GV00002', N'Nguyễn Thị Như Lan', '02-12-1984', N'Nữ', NULL, 'GV00005'),
 ('GV00003', N'Trần Minh Anh', '23-03-1986', N'Nam', '0909123999', 'GV00002'),
 ('GV00004', N'Trương Tường Vi', '01-02-1988', N'Nữ', '0998990909', 'GV00008'),
 ('GV00005', N'Hà Anh Tuấn', '12-03-1986', N'Nam', '0909909000', 'GV00008'),
 ('GV00006', N'Trần Anh Dũng', '04-04-1979', N'Nam', NULL, 'GV00010'),
 ('GV00007', N'Trần Duy Tân', '04-01-1978', N'Nam', NULL, 'GV00002'),
 ('GV00008', N'Nguyễn Thị Linh', '08-07-1979', N'Nữ', '0938079700', 'GV00009'),
 ('GV00009', N'Trần Thị Kiều', '03-01-1977', N'Nữ', NULL, NULL),
 ('GV00010', N'Trần Phương Loan', '30-04-1978', N'Nữ', NULL, NULL);

INSERT INTO KETQUA
VALUES
('HV000001', 'MH00001', 1, 5.5),
('HV000001', 'MH00004', 1, 6),
('HV000002', 'MH00001', 1, 7),
('HV000002', 'MH00004', 1, 8),
('HV000003', 'MH00008', 1, 8.7),
('HV000003', 'MH00009', 1, 9),
('HV000003', 'MH00010', 1, 10),
('HV000004', 'MH00008', 1, 4),
('HV000004', 'MH00008', 2, 3),
('HV000004', 'MH00009', 1, 2),
('HV000004', 'MH00009', 2, 5),
('HV000004', 'MH00010', 1, 6),
('HV000005', 'MH00008', 1, 7.5),
('HV000005', 'MH00009', 1, 1),
('HV000005', 'MH00009', 2, 7),
('HV000005', 'MH00010', 1, 1),
('HV000005', 'MH00010', 2, 3.5);

INSERT INTO GIAOVIEN_DAY_MONHOC
VALUES
('GV00001', 'MH00001', 3, NULL),
('GV00001', 'MH00004', 2, NULL),
('GV00002', 'MH00001', 1, NULL),
('GV00002', 'MH00002', 1, NULL),
('GV00003', 'MH00006', 2, NULL),
('GV00003', 'MH00007', 3, NULL),
('GV00003', 'MH00010', 4, NULL),
('GV00004', 'MH00009', 6, NULL),
('GV00004', 'MH00010', 1, NULL),
('GV00005', 'MH00008', 4, NULL),
('GV00005', 'MH00010', 2, NULL),
('GV00006', 'MH00008', 4, NULL),
('GV00006', 'MH00009', 2, NULL),
('GV00006', 'MH00010', 4, NULL),
('GV00007', 'MH00010', 7, NULL),
('GV00008', 'MH00001', 2, NULL),
('GV00008', 'MH00002', 1, NULL),
('GV00009', 'MH00010', 2, NULL),
('GV00010', 'MH00001', 3, NULL),
('GV00010', 'MH00002', 1, NULL);

INSERT INTO PHANCONG
VALUES
('GV00001', 'MH00001', 'LH000001'),
('GV00001', 'MH00004', 'LH000001'),
('GV00003', 'MH00010', 'LH000005'),
('GV00004', 'MH00009', 'LH000004'),
('GV00005', 'MH00008', 'LH000002'),
('GV00005', 'MH00008', 'LH000004'),
('GV00006', 'MH00008', 'LH000003'),
('GV00006', 'MH00009', 'LH000002'),
('GV00006', 'MH00009', 'LH000003'),
('GV00006', 'MH00010', 'LH000004'),
('GV00007', 'MH00010', 'LH000002'),
('GV00007', 'MH00010', 'LH000003'),
('GV00008', 'MH00002', 'LH000004');